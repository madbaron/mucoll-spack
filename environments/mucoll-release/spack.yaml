spack:

  packages:
    acts:
      require: '@32.1.0'

    mucoll-stack:
      require: '@full_gaudi_test: +devtools+pytools' #+ml'

    py-setuptools:
      require: "@69"

    dd4hep:
      require: '+edm4hep+lcio+xercesc+hepmc3'

    k4geo:
      require: '@main'
    k4gaudipandora:
      require: '@main'
    k4reco:
      require: '@main'
    k4actstracking:
      require: '@main'

    forwardtracking:
      require: '@1.14.2'
    conformaltracking:
      require: '@1.12.1'
    marlintrkprocessors:
      require: '@2.16'
    muoncvxddigitiser:
      require: '@0.2.2'
    ddmarlinpandora:
      require: +monitoring
    lccontent:
      require: +monitoring

    # Use the system OpenGL as recommended by spack
    # See https://github.com/key4hep/key4hep-spack/issues/318 and
    # https://github.com/key4hep/key4hep-spack/issues/516
    # A version is needed and we set it to 99 so that spack thinks it's the latest
    # (it may not work if the versions in the current system are not what's required
    # but that hasn't happened yet)
    opengl:
      buildable: False
      externals:
      - spec: opengl@99
        prefix: /usr
    openglu:
      buildable: False
      externals:
      - spec: openglu@99
        prefix: /usr
    mesa:
      buildable: False
      externals:
      - spec: mesa@99
        prefix: /usr
    mesa-glu:
      buildable: False
      externals:
      - spec: mesa-glu@99
        prefix: /usr
    # Use the system kerberos, otherwise the tickets obtained at login with the
    # system version don't appear for the spack kerberos (happening on lxplus at least)
    krb5:
      buildable: False
      externals:
      - spec: krb5@99
        prefix: /usr
    # Use the system ssh, otherwise the configuration for the provided ssh will likely be
    # different and things like ssh using kerberos won't work (by extension authentication
    # for git with ssh with kerberos)
    openssh:
      buildable: False
      externals:
      - spec: openssh@99
        prefix: /usr

    all:
      target: [x86_64]
      variants: build_type=RelWithDebInfo cxxstd=20
      buildable: true
      providers:
        gl: [mesa]
        glu: [mesa]

  concretizer:
    unify: true

  view: false

  specs:
  - mucoll-stack
